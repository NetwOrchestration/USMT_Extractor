@echo off
pushd %~dp0
set Cab_X86=5ac1863798809c64e85c2535a27a3da6.cab
set Cab_AMD64=4d2878f43060bacefdd6379f2dae89b0.cab
set Cab_ARM64=8c9919a5e8638dd2b352b0a218939370.cab
set "SourceDir=%CD%\User State Migration Tool\"
set "Cat=>>Catalog.csv"
set "echo=echo =================================================="
md USMT
attrib +h USMT

:X86
if exist %Cab_X86% (
	cls
	%echo%
	echo.
	echo Extracting USMT x86...
	echo.
	%echo%
	md USMT\x86
	expand -f:* %Cab_X86% USMT\x86 >nul
	pushd USMT\x86
	echo file6924986e372d07315a9d374081ebbd7,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-ServerManager-Shell-Replacement.man%Cat%
	echo fil6393ee024f92693b9813eb6aeab93038,%SourceDir%x86\ReplacementManifests\msmpeg2vdec-migration-replacement.man%Cat%
	echo fil0f8e420578bdc020ce9bf7a587b49bd1,%SourceDir%x86\ReplacementManifests\mfsrcsnk-migration-replacement.man%Cat%
	echo fil2cb42cfddef859748b06a3b28991fd9c,%SourceDir%x86\ReplacementManifests\mfmpeg2srcsnk-migration-replacement.man%Cat%
	echo fil69445a975c57ae91aec48ad31199fba4,%SourceDir%x86\ReplacementManifests\winmde-migration-replacement.man%Cat%
	echo filc3db36ca4e9c92b00f7fe03026474326,%SourceDir%x86\ReplacementManifests\Application-Experience-Program-Compatibility-Assistant-Replacement.man%Cat%
	echo fil9453379a311747b9d079cafe41fcfc5c,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-OfflineFiles-Replacement.man%Cat%
	echo fil43f0d8b416c5639763c56c57587c6803,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-OfflineFiles-Core\cscmig.dll%Cat%
	echo fild1d22b122e86781f2d44dfeb6c09eaec,%SourceDir%x86\ReplacementManifests\DataIntegrityScan-Replacement.man%Cat%
	echo fil9c5a7d75dabfc19ae006b0faa4254707,%SourceDir%x86\csiagent.dll%Cat%
	echo filedd365bb6780267bbd62a90dce1729ed,%SourceDir%x86\mxeagent.dll%Cat%
	echo fileeae5b001a2a75686930d42b860dd916,%SourceDir%x86\mighost.exe%Cat%
	echo fil2f7eed874beea922d90b9967e67b5f12,%SourceDir%x86\migstore.dll%Cat%
	echo fil8e4ed48ca966460cd6dee2bef8c04e56,%SourceDir%x86\migcore.dll%Cat%
	echo fil512c971cc78cc91ee493ac3c6b52818d,%SourceDir%x86\migsys.dll%Cat%
	echo fil6101fc1c6b89b0b715b20d97d44a7559,%SourceDir%x86\migres.dll%Cat%
	echo fil5c5cb5f232581e9a283144b2b8746f96,%SourceDir%x86\MigApp.xml%Cat%
	echo fil52c6d7ab678a9403534f63a41ebdb14c,%SourceDir%x86\MigUser.xml%Cat%
	echo filfa05e24dee83d1abfc43bd0a2c68d310,%SourceDir%x86\MigDocs.xml%Cat%
	echo fil00cae3b93a69324c4a69ca2c6e569140,%SourceDir%x86\MigXML.xsd%Cat%
	echo filf960d86997ba544c0c85513dd4b13ed7,%SourceDir%x86\Config_AppsOnly.xml%Cat%
	echo fil243c46f63b8300b4d0356600b7370606,%SourceDir%x86\Config_SettingsOnly.xml%Cat%
	echo fil9ec5af31da864107c97e0cd550419c48,%SourceDir%x86\Config_AppsAndSettings.xml%Cat%
	echo fila80517740ee098c85638ac9027f20d64,%SourceDir%x86\cmi2migxml.dll%Cat%
	echo fil9ef98f45df63761f7ed9cc8ff70c1d39,%SourceDir%x86\loadstate.exe%Cat%
	echo fil7869f78dce29765459d4f8e780828496,%SourceDir%x86\ReplacementManifests7\Application-Experience-Program-Compatibility-Assistant-Replacement.man%Cat%
	echo file72f17a93d26c01497a5d5bfaed35da6,%SourceDir%x86\ReplacementManifests7\eudcedit-replacement.man%Cat%
	echo fil38c3956759de24d1b81deeec63574ac1,%SourceDir%x86\ReplacementManifests7\ExtensibleAuthenticationProtocolHostService-Rep.man%Cat%
	echo fil1a122c8d4611559ae8bbd505b3ff96f9,%SourceDir%x86\ReplacementManifests7\International-Core-replacement.man%Cat%
	echo filb2dcbe29bac0d2ad3e6da246146614c4,%SourceDir%x86\ReplacementManifests7\Microsoft-Windows-Fax-Service-Replacement.man%Cat%
	echo fil00d9a9972bd580ab111a5e7ae89e0d2e,%SourceDir%x86\ReplacementManifests7\Microsoft-Windows-IE-InternetExplorer-repl.man%Cat%
	echo fildbb2871b3d4b4ce5e9c556a2d259120e,%SourceDir%x86\ReplacementManifests7\Microsoft-Windows-NETFX35CDFComp-Replacement.man%Cat%
	echo filf6581d5f85094140db59a1492a056d72,%SourceDir%x86\ReplacementManifests7\Microsoft-Windows-OfflineFiles-Replacement.man%Cat%
	echo filffe524203147d2d2638fd54499e24540,%SourceDir%x86\ReplacementManifests7\Microsoft-Windows-WCFCoreComp-Replacement.man%Cat%
	echo fil862fc7348bdfb7f15c3eb410f3ba0a7e,%SourceDir%x86\ReplacementManifests7\mmsys-Migration-Replacement.man%Cat%
	echo fil986f3c3510e29fd4a9e634ae3336bd77,%SourceDir%x86\ReplacementManifests7\odbc32dll-Repl.man%Cat%
	echo filacdca17230861ae1ed05417ec1e4b7a0,%SourceDir%x86\ReplacementManifests7\Printing-LocalPrinting-Replacement.man%Cat%
	echo filc2cacd081859b1a66fa16400992057dc,%SourceDir%x86\ReplacementManifests7\RasApi-Repl.man%Cat%
	echo fil442dad2a7d962bc70ca37d1287988998,%SourceDir%x86\ReplacementManifests7\RasmanService-Repl.man%Cat%
	echo fil48ea6a0f3768e853a12d0e0e62d06924,%SourceDir%x86\ReplacementManifests7\Rasppp-Repl.man%Cat%
	echo filbc76246b3e24c9c2e1afe4f8c5fda946,%SourceDir%x86\ReplacementManifests7\Rights-Management-Client-v1-API-Replacement.man%Cat%
	echo filbfd52840a981f89d9d2653b6e04d906b,%SourceDir%x86\ReplacementManifests7\shmig-Replacement.man%Cat%
	echo filcbd51f074872923248642cace8371213,%SourceDir%x86\ReplacementManifests7\sounds-Migration-Replacement.man%Cat%
	echo fil23d827a7db6d2c54849d22e963175cf6,%SourceDir%x86\ReplacementManifests7\stickyNotes-Replacement.man%Cat%
	echo fild84b62e55ec7b865aa374dc475bf1623,%SourceDir%x86\ReplacementManifests7\sysdm-replacement.man%Cat%
	echo filcb0300df9233fe6d477b66188ca2686e,%SourceDir%x86\ReplacementManifests7\SysMain-Replacement.man%Cat%
	echo fil31d2a583f7a9a69c34c733aeb4a3b244,%SourceDir%x86\ReplacementManifests7\TabletPCStickyNotes-Replacement.man%Cat%
	echo filf98a3870488b051292799e50175ded20,%SourceDir%x86\ReplacementManifests7\TerminalServices-AppServer-Licensing-Replacement.man%Cat%
	echo fil18b7bfee501996334048311734d95541,%SourceDir%x86\ReplacementManifests7\TerminalServices-LicenseServer-Replacement.man%Cat%
	echo fil70477910e1fc7a93a2fb9b4e75c3f4b5,%SourceDir%x86\ReplacementManifests7\TerminalServices-Manager-SnapIn-Replacement.man%Cat%
	echo fil82a901211c16a40d7f3ffa20932285ee,%SourceDir%x86\ReplacementManifests7\TerminalServices-RAPWebPart-Replacement.man%Cat%
	echo fil74b3ac5072dbb862b2fe92e22e6b119e,%SourceDir%x86\ReplacementManifests7\WCF-HTTP-Activation-Replacement.man%Cat%
	echo filf6c6c2640fc1c28d8bc3c1f65b22173a,%SourceDir%x86\ReplacementManifests7\WCF-NonHTTP-Activation-Replacement.man%Cat%
	echo fil57526d637fe30e74cdaeb292f3153475,%SourceDir%x86\ReplacementManifests7\WindowsSearchEngine-replacement.man%Cat%
	echo fil3a06df100cfb1083f1d89a97f0159518,%SourceDir%x86\ReplacementManifests7\WSRM-Service-Replacement.man%Cat%
	echo fil52fd2da4d27932d2a508e895a80e5d89,%SourceDir%x86\ReplacementManifests8\Application-Experience-Program-Compatibility-Assistant-Replacement.man%Cat%
	echo fil9f06200c18506a0e64bdd8a3db5ce4b5,%SourceDir%x86\ReplacementManifests8\CAPI2_certs-repl.man%Cat%
	echo fil3b4c5fd0aea5a61a41f4f6f681f68b51,%SourceDir%x86\ReplacementManifests8\CertificateEnrollment-Replacement.man%Cat%
	echo fil695d100ed810a9c2f33427b317e950e2,%SourceDir%x86\ReplacementManifests8\DisplayConfigSettings_Win7Update.man%Cat%
	echo fil881cf4d533e45c9b34f3bfee8e19f443,%SourceDir%x86\ReplacementManifests8\eudcedit-replacement.man%Cat%
	echo fila162a7a6a12d6fc4e8a08c6604097a64,%SourceDir%x86\ReplacementManifests8\explorer-repl.man%Cat%
	echo fil8c5a19fbcf9a4307aee54828c9e16bb1,%SourceDir%x86\ReplacementManifests8\ExtensibleAuthenticationProtocolHostService-Rep.man%Cat%
	echo fil6b9491ba71579a232fa982e02ca75636,%SourceDir%x86\ReplacementManifests8\IdentityServer-Migration-Replacement.man%Cat%
	echo fila29b483f5a2184351a19a6b882dabe58,%SourceDir%x86\ReplacementManifests8\IdentityServer-ProxyMigration-Replacement.man%Cat%
	echo fil9e39bc82de4f7040673c00e97b5fc554,%SourceDir%x86\ReplacementManifests8\International-Core-replacement.man%Cat%
	echo fil35e6f7087f239a49ff31f361f34194d9,%SourceDir%x86\ReplacementManifests8\Internet-Naming-Service-Runtime-Rep.man%Cat%
	echo fil789e51013a8486b09eb0a81ef2e28b7e,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-Fax-Service-Replacement.man%Cat%
	echo file4e6881b2a8368905e647fe8f1f586d6,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-Identity-Foundation-Migration-Replacement.man%Cat%
	echo fil0f9301b747d8a375d99180ef2ca4fcf8,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-IE-InternetExplorer-repl.man%Cat%
	echo file3e81dcce78c4fb3586645181192381f,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-IE-PDM-Replacement.man%Cat%
	echo fil76d7d72aab18cf7a519bd4047b2a6321,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-NETFX35CDFComp-Replacement.man%Cat%
	echo file477cfe3f72206a3895abc87d13abb52,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-OfflineFiles-Replacement.man%Cat%
	echo filbd22bb52389c360c44fd01ec0579a36b,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-PowerShell-Replacement.man%Cat%
	echo fil70ae3fae3b4ceda5534a350d7266cb9d,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-PowerShell-WS08-Replacement.man%Cat%
	echo fila3ca52f446ed5d5e1f13b460e5692a7e,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-WCFCoreComp-Replacement.man%Cat%
	echo fil1db15c2f6258bb45457785a363b9de29,%SourceDir%x86\ReplacementManifests8\mmsys-Migration-Replacement.man%Cat%
	echo fil8d13c9f7950ddbb8f7a2ad7899ee0d7d,%SourceDir%x86\ReplacementManifests8\Netfx4-Policy-Replacement.man%Cat%
	echo filc884c198ea92833434e37e8f7093483e,%SourceDir%x86\ReplacementManifests8\odbc32dll-Repl.man%Cat%
	echo fil6db5a523613552cdb660783b42c13197,%SourceDir%x86\ReplacementManifests8\PeerDist-Client-Migration-Replacement.man%Cat%
	echo fil3b0caf7369076560cd314039985e56b6,%SourceDir%x86\ReplacementManifests8\PeerDist-Server-Migration-Replacement.man%Cat%
	echo fil49e789e1b61535be751ba20cc1a53b35,%SourceDir%x86\ReplacementManifests8\Printing-LocalPrinting-Replacement.man%Cat%
	echo fil6a3531916cb7b3785a1dc3b7302d2ac2,%SourceDir%x86\ReplacementManifests8\RasApi-Repl.man%Cat%
	echo fil79ffdf51953aad5c586f24ec0c479dd9,%SourceDir%x86\ReplacementManifests8\RasBase-Rassstp-Repl.man%Cat%
	echo fil16d959ace625af9ead0b5065d426acd2,%SourceDir%x86\ReplacementManifests8\RasBase-Repl.man%Cat%
	echo fil1be72aefbd83e21f827392cfdcdc24ee,%SourceDir%x86\ReplacementManifests8\RasmanService-Repl.man%Cat%
	echo fil5eeccb6fabc0c3616c4e27db85bd1b53,%SourceDir%x86\ReplacementManifests8\RasmanService-ReplV2.man%Cat%
	echo filf7b068dfb75fceda4fee8be329568ba0,%SourceDir%x86\ReplacementManifests8\Rasppp-Repl.man%Cat%
	echo fil158db48762093d56629d162757a76768,%SourceDir%x86\ReplacementManifests8\RasRqs-Repl.man%Cat%
	echo fil0f733e0fb8bdbbf57faa42d5c0e3fdf5,%SourceDir%x86\ReplacementManifests8\Rights-Management-Client-v1-API-Replacement.man%Cat%
	echo fil4ac3e66f35b177dc8633d5fcab97b3d1,%SourceDir%x86\ReplacementManifests8\shmig-replacement.man%Cat%
	echo fil84f909a2c4e22e1fb44ce5fc73fc40d7,%SourceDir%x86\ReplacementManifests8\sounds-Migration-Replacement.man%Cat%
	echo filed444cbf2a09d12eef563825e4cc929c,%SourceDir%x86\ReplacementManifests8\stickyNotes-Replacement.man%Cat%
	echo fil0503425ea85cb0559e2c05d1e2776795,%SourceDir%x86\ReplacementManifests8\sysdm-replacement.man%Cat%
	echo fil0fccdef995c702b782a1cabac7913146,%SourceDir%x86\ReplacementManifests8\SysMain-Replacement.man%Cat%
	echo fil85743b0488a38f86546944f9c3d328f8,%SourceDir%x86\ReplacementManifests8\TabletPCStickyNotes-Replacement.man%Cat%
	echo fil92e467b251ac0f2fc7a16d8f747775e1,%SourceDir%x86\ReplacementManifests8\TerminalServices-AppServer-Licensing-Replacement.man%Cat%
	echo fil63df58fc8d8c1fa065d43544369fde4f,%SourceDir%x86\ReplacementManifests8\TerminalServices-LicenseServer-Replacement.man%Cat%
	echo fil4a29e10b7018f6535e055aa39b244ae1,%SourceDir%x86\ReplacementManifests8\TerminalServices-RAPWebPart-Replacement.man%Cat%
	echo fil61957d698b2ee412a4021215e0ffcda1,%SourceDir%x86\ReplacementManifests8\TerminalServices-RDP-WinStationExtensions-Replacement.man%Cat%
	echo filcdbfc1d7fffe24153cf3d75b7d7eac29,%SourceDir%x86\ReplacementManifests8\TerminalServices-SessionDirectory-Client-Replacement.man%Cat%
	echo fil6f01f5d61a1e42467b90022411beac02,%SourceDir%x86\ReplacementManifests8\UDFS-Replacement.man%Cat%
	echo fil11b84c8eea59ea58581d1b4e31665f8f,%SourceDir%x86\ReplacementManifests8\VirtualDiskService-Repl.man%Cat%
	echo fil451116f085b30c0dd924723979c7382f,%SourceDir%x86\ReplacementManifests8\WCF-HTTP-Activation-Replacement.man%Cat%
	echo fil7c509ad102806cee5d96bc25b673ac22,%SourceDir%x86\ReplacementManifests8\WCF-NonHTTP-Activation-Replacement.man%Cat%
	echo fil7f9115e272167876f665d342955e0408,%SourceDir%x86\ReplacementManifests8\WindowsSearchEngine-replacement.man%Cat%
	echo fil666db6a31ed74abe011e9367b3eb185a,%SourceDir%x86\ReplacementManifests8\Winlogon-Replacement.man%Cat%
	echo fil76ccf09bb4bda123b7c571596042fb5c,%SourceDir%x86\ReplacementManifests8\WSRM-Service-Replacement.man%Cat%
	echo fil039b6a8de63b9c8db0efdf578c0a9dfa,%SourceDir%x86\ReplacementManifests7\Microsoft-Windows-shmig\shmig.dll%Cat%
	echo filed1ffb585da215dcb9d7de3fccb7e2b3,%SourceDir%x86\ReplacementManifests7\Microsoft-Windows-TerminalServices-LicenseServer\TlsRepPlugin.dll%Cat%
	echo fil5d555acb644e3ac7085ec47e66f1a89b,%SourceDir%x86\ReplacementManifests7\WindowsSearchEngine\WSearchMigPlugin.dll%Cat%
	echo filde841f95be3b4faf9a16ca043b5dd5aa,%SourceDir%x86\ReplacementManifests8\Microsoft-Windows-shmig\shmig.dll%Cat%
	echo fil418fe2c93ebfb3f4b496aa429f8f5634,%SourceDir%x86\ReplacementManifests8\WindowsSearchEngine\WSearchMigPlugin.dll%Cat%
	echo fild009e64940cc1ef743f75530ee331712,%SourceDir%x86\scanstate.exe%Cat%
	echo fil70b5c05de63ba4a0dacc471268209613,%SourceDir%x86\usmtutils.exe%Cat%
	echo fil582fab7d9e5444db70eb9d349b57befa,%SourceDir%x86\SFPAT.INF%Cat%
	echo fildf50ea6d532ee41c1a9fdd7379e25c05,%SourceDir%x86\SFPATRS1.INF%Cat%
	echo fil53cfe360f04f54af43ad699fad276e4d,%SourceDir%x86\SFPATWT.INF%Cat%
	echo filf10223209d48291e15743dbaa7cd69d0,%SourceDir%x86\SFPATWB.INF%Cat%
	echo fil2cefc93b64273c782951232fd245f028,%SourceDir%x86\SFPATW8.INF%Cat%
	echo fil39e9318dc12125d0ee48c6cdc1ad1b21,%SourceDir%x86\SFPATW7.INF%Cat%
	echo fil337e4e64ca375e141bab8e3d1373490d,%SourceDir%x86\SFCN.DAT%Cat%
	echo fil55124e23d5b1167f3e3c9c22ac22a54c,%SourceDir%x86\SFLCID.DAT%Cat%
	echo fil24215d68434cee5d3f20d7bb3029bc7e,%SourceDir%x86\SFLISTRS1.DAT%Cat%
	echo filc458eb1d102cbbae933f8c8a07710a91,%SourceDir%x86\SFLISTWT.DAT%Cat%
	echo filb721eadf181bec9ed6f06e2438f1d2f3,%SourceDir%x86\SFLISTWT.WOA.DAT%Cat%
	echo filedb04d4eff099c301d636b9004be424a,%SourceDir%x86\SFLISTWB.DAT%Cat%
	echo fil181c6d8af6e7d9aee5712a790918a1ff,%SourceDir%x86\SFLISTWB.WOA.DAT%Cat%
	echo fil84765a5991a463f79570563d42b37d62,%SourceDir%x86\SFLISTW8.DAT%Cat%
	echo fil29268808f5b7dbda594f84417c683363,%SourceDir%x86\SFLISTW8.WOA.DAT%Cat%
	echo fil4ef85698bf6ec1a750b3ce6d7ca929f2,%SourceDir%x86\SFLISTW7.DAT%Cat%
	echo filc8ecbb1645890bcc778f92151180dfc0,%SourceDir%x86\unbcl.dll%Cat%
	echo fil255f1e04e9a92ad37c877c16904e25ea,%SourceDir%x86\ReplacementManifests\VirtualDiskService-Repl.man%Cat%
	echo filc6d3155a7fcf5a8dd8c0840668343329,%SourceDir%x86\DLManifests\International-TimeZones-DL.man%Cat%
	echo filfb35331ee5c3defcd747926885951210,%SourceDir%x86\ReplacementManifests\International-Core-replacement.man%Cat%
	echo fil4c0fcf4a5d408fd3eca632fd55f80095,%SourceDir%x86\ReplacementManifests\IdentityServer-Migration-Replacement.man%Cat%
	echo fil2fc66d0591b982fbff5591920f88f608,%SourceDir%x86\ReplacementManifests\IdentityServer-ProxyMigration-Replacement.man%Cat%
	echo fil1e80fd3b5534b525e6bd8678d8bfb974,%SourceDir%x86\DLManifests\dpapi_keys-DL.man%Cat%
	echo fil312a9b4c99f191bf8cae4a0c8a6e97d9,%SourceDir%x86\ReplacementManifests\dpapi_keys-repl.man%Cat%
	echo fil6ec74e4a67dc232c3fbef1dc3650e164,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-Identity-Foundation-Migration-Replacement.man%Cat%
	echo fil4f3c019e438e05248280eb11155c0870,%SourceDir%x86\ReplacementManifests\Rights-Management-Client-v1-API-Replacement.man%Cat%
	echo fil9fdbd54f4775b91400f40576ea286a60,%SourceDir%x86\ReplacementManifests\Winlogon-Replacement.man%Cat%
	echo fil0953776c8390cc33b2f294c45392c94b,%SourceDir%x86\ReplacementManifests\odbc32dll-Repl.man%Cat%
	echo fil8cb2278004f9b81f5cb3e1dbee106d8b,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-IE-InternetExplorer-repl.man%Cat%
	echo fil1308b32b0f1cfd5e245bbbd2a5f597e7,%SourceDir%x86\ReplacementManifests\ReFS-Replacement.man%Cat%
	echo filc4f5bd35f4f47c19539ca951e1c77b51,%SourceDir%x86\ReplacementManifests\ReFS-v1-Replacement.man%Cat%
	echo file3eab8adcce998d72b4896752361af90,%SourceDir%x86\ReplacementManifests\mmsys-Migration-Replacement.man%Cat%
	echo filcd2d10ceade71f7dda2c592bf7c2720b,%SourceDir%x86\ReplacementManifests\sounds-Migration-Replacement.man%Cat%
	echo filada127d98f915711917e7ffd46a47193,%SourceDir%x86\ReplacementManifests\PeerDist-Server-Migration-Replacement.man%Cat%
	echo fil68dc54a2662c89cdff20028d0f60eeed,%SourceDir%x86\ReplacementManifests\PeerDist-Client-Migration-Replacement.man%Cat%
	echo fil30028d4d5bf03b777d1d41959d3afbdd,%SourceDir%x86\ReplacementManifests\RasApi-Repl.man%Cat%
	echo filc9edf39c5c66bcaaa715c84710c680af,%SourceDir%x86\ReplacementManifests\RasRqs-Repl.man%Cat%
	echo fil7edfdefdfbcb73309d8a4fa87ab3cbd3,%SourceDir%x86\ReplacementManifests\RasBase-Rassstp-Repl.man%Cat%
	echo file7768e365a60bb84da74debc4ee9440d,%SourceDir%x86\ReplacementManifests\Internet-Naming-Service-Runtime-Rep.man%Cat%
	echo fil8b25a857c32b7fae261784bffd472cee,%SourceDir%x86\ReplacementManifests\UDFS-Replacement.man%Cat%
	echo fil6f250854e3d214cdeac86d173ccafba2,%SourceDir%x86\ReplacementManifests\PCPKsp_dll-repl.man%Cat%
	echo filcb6b64376cbb2bfe6626302a9309edec,%SourceDir%x86\wdscore.dll%Cat%
	echo filb2c7ec964faa601f747e44c4412bbe4e,%SourceDir%x86\ReplacementManifests\SysMain-Replacement.man%Cat%
	echo fil4a7c6183c6974bd2eae17c51bc0fa1c8,%SourceDir%x86\ReplacementManifests\CAPI2_certs-repl.man%Cat%
	echo fil4099c73078f5dc57b0e1c10f30e3fcbc,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-Security-NGC-CtnrSvc-repl.man%Cat%
	echo fil66bd71252ab6616fa6d86716a261669f,%SourceDir%x86\ReplacementManifests\ngcpopkeysrv_dll-repl.man%Cat%
	echo filc64540f9acb045835e2244acc30a1b7e,%SourceDir%x86\ReplacementManifests\CertificateEnrollment-Replacement.man%Cat%
	echo fil11e3ae3f509d793eea932edea7f43241,%SourceDir%x86\ReplacementManifests\WindowsSearchEngine-replacement.man%Cat%
	echo fil5d6f0ae520e04e3bb3d9b4c045e8f29c,%SourceDir%x86\ReplacementManifests\WindowsSearchEngine\WSearchMigPlugin.dll%Cat%
	echo fil385bbbe86be44727328bdc3d83c05180,%SourceDir%x86\ReplacementManifests\wlidsvc.vista-win7.man%Cat%
	echo fildf45cd185c42fc0c23c9991def339219,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-IE-ClientNetworkProtocolImplementation-repl.man%Cat%
	echo filf3bb861e52ed79ae7a02f3102d3d0408,%SourceDir%x86\ReplacementManifests\ExtensibleAuthenticationProtocolHostService-Rep.man%Cat%
	echo fil9539045de836e8547e16dbb3ffe7f45c,%SourceDir%x86\ReplacementManifests\Rasppp-Repl.man%Cat%
	echo fildf6f8e09aedf46e9fcc4e3bbcd90d632,%SourceDir%x86\ReplacementManifests\RasmanService-Repl.man%Cat%
	echo fil384eddcd015d507588e36bd61b1b32d2,%SourceDir%x86\ReplacementManifests\RasmanService-ReplV2.man%Cat%
	echo filda6dc50d69fc213853c2212c6699e3a0,%SourceDir%x86\ReplacementManifests\RasBase-Repl.man%Cat%
	echo fil4216b0111af9c50fb79ba08557e41616,%SourceDir%x86\ReplacementManifests\UPnPDeviceHost-Replacement.man%Cat%
	echo filefece99c307dfb0b44fbd84dba3d2c42,%SourceDir%x86\ReplacementManifests\UPnPDeviceHost-Server-Replacement.man%Cat%
	echo fil530e6dc776c7e9f2f351273d05e3eec9,%SourceDir%x86\ReplacementManifests\UPnPSSDP-Replacement.man%Cat%
	echo fildc0c5a791f05c9bc0a8fa3c697cec290,%SourceDir%x86\ReplacementManifests\UPnPSSDP-Server-Replacement.man%Cat%
	echo fil5ec1e00b4311ec5660bd889c43ca113c,%SourceDir%x86\ReplacementManifests\win32k-settings-repl.man%Cat%
	echo fil6c1ef3af1bccc48f7218a60b4a14f44e,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-Fax-Service-Replacement.man%Cat%
	echo fil222ed6c23123e1bdf3c3ecba3afd6b52,%SourceDir%x86\ReplacementManifests\Printing-LocalPrinting-Replacement.man%Cat%
	echo file883ffc62a6ede5f5c796442be20dac4,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-NETFX35CDFComp-Replacement.man%Cat%
	echo filc7421d52a9c24a1d34ff953d57fd2576,%SourceDir%x86\ReplacementManifests\Netfx4-Policy-Replacement.man%Cat%
	echo fil604ce442d323303bf122e31cdde4ec8a,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-WCFCoreComp-Replacement.man%Cat%
	echo fil24e3b15ee3e51c0452c368d2ae1bff17,%SourceDir%x86\ReplacementManifests\WCF-HTTP-Activation-Replacement.man%Cat%
	echo fil5bb93d39cb0de4fe42ccbbb796e2a02a,%SourceDir%x86\ReplacementManifests\WCF-NonHTTP-Activation-Replacement.man%Cat%
	echo fil1cb924b1c4284a4d3ae45623b4053d63,%SourceDir%x86\ReplacementManifests\sysdm-replacement.man%Cat%
	echo fil5bb3e118f90871844d341fc8c30664cf,%SourceDir%x86\ReplacementManifests\explorer-repl.man%Cat%
	echo fil19625517d2d8c9fd588f4df1c264602a,%SourceDir%x86\ReplacementManifests\eudcedit-replacement.man%Cat%
	echo fila6e4cf511c20c6ef40eee2d99d4ba0e3,%SourceDir%x86\ReplacementManifests\notepad-repl.man%Cat%
	echo fil1318ace31f44c041608f617c4194eb23,%SourceDir%x86\ReplacementManifests\shmig-replacement.man%Cat%
	echo fila0b983ebc4572cdfd3e8cf0239709c9b,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-shmig\shmig.dll%Cat%
	echo filb9e9c5b881b242ba8979730e0963475a,%SourceDir%x86\ReplacementManifests\TerminalServices-AppServer-Licensing-Replacement.man%Cat%
	echo fil01fead5c0203efc19e2ee70eab8697c0,%SourceDir%x86\ReplacementManifests\TerminalServices-RAPWebPart-Replacement.man%Cat%
	echo fil581bfbb23b4072d99e9424e2871a2f0f,%SourceDir%x86\ReplacementManifests\TerminalServices-LicenseServer-Replacement.man%Cat%
	echo filc6ae9075a5c8b36e219d6e9561f70058,%SourceDir%x86\ReplacementManifests\TerminalServices-RDP-WinStationExtensions-Replacement.man%Cat%
	echo fil8ebb49f28338ce7e459edf9724b09c61,%SourceDir%x86\ReplacementManifests\TerminalServices-SessionDirectory-Client-Replacement.man%Cat%
	echo fil4a113c1f60df0948a2093a33b062fed6,%SourceDir%x86\DLManifests\TextServicesFramework-Migration-DL.man%Cat%
	echo fil9a731e5cfee967cc2710dd8c18e65a9c,%SourceDir%x86\ReplacementManifests\TextServicesFramework-Migration-Replacement.man%Cat%
	echo filc2c0c3ddb9ea4e35968d78286f4898eb,%SourceDir%x86\DLManifests\Microsoft-Windows-TextServicesFramework-Migration-DL\msctfmig.dll%Cat%
	echo fil7763e73cd3f0f9e2a313d2d775963710,%SourceDir%x86\ReplacementManifests\Microsoft-Windows-TextServicesFramework-Migration\msctfmig.dll%Cat%
	echo fil7c0d063e6dd2c8e1a959f4d3aa7b931f,%SourceDir%x86\ReplacementManifests\DisplayConfigSettings_Win7Update.man%Cat%
 	for /f "tokens=1,2 delims=," %%a in (Catalog.csv) do (
		md "%%b"
		rd "%%b"
		move %%a "%%b" >nul
	)
	popd
)

:AMD64
if exist %Cab_AMD64% (
	cls
	%echo%
	echo.
	echo Extracting USMT amd64...
	echo.
	%echo%
	md USMT\amd64
	expand -f:* %Cab_AMD64% USMT\amd64 >nul
	pushd USMT\amd64
	echo fil4974b58f5a143a6bab959d45ece2563c,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-ServerManager-Shell-Replacement.man%Cat%
	echo fil7c260f9646714147ffdbdb33a26521c3,%SourceDir%amd64\ReplacementManifests\msmpeg2vdec-migration-replacement.man%Cat%
	echo fil4b2ff568e6ccc364498da846edd25bb9,%SourceDir%amd64\ReplacementManifests\mfsrcsnk-migration-replacement.man%Cat%
	echo filb479b3f8c7425aa4cd128ffa45d19e8d,%SourceDir%amd64\ReplacementManifests\mfmpeg2srcsnk-migration-replacement.man%Cat%
	echo fil425d47092c36e8e605244bcade7119f4,%SourceDir%amd64\ReplacementManifests\winmde-migration-replacement.man%Cat%
	echo fil48d73191c99e23a291d3a559f17a149a,%SourceDir%amd64\ReplacementManifests\Application-Experience-Program-Compatibility-Assistant-Replacement.man%Cat%
	echo filb92a511490ee70f0236654730dc2b7f7,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-OfflineFiles-Replacement.man%Cat%
	echo filb4a7d05287bafe4497850511689e798f,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-OfflineFiles-Core\cscmig.dll%Cat%
	echo fil6243a4b4a3df0f07c7d067d71a335369,%SourceDir%amd64\ReplacementManifests\DataIntegrityScan-Replacement.man%Cat%
	echo fil4f28f1f4f7571405e3e3ef2dba42c067,%SourceDir%amd64\csiagent.dll%Cat%
	echo fil494e1d6e7961933dae64e36bc6df0630,%SourceDir%amd64\mxeagent.dll%Cat%
	echo fil7439d4ab0edff97b9dc97209eb58b172,%SourceDir%amd64\mighost.exe%Cat%
	echo fila48859f05a47b11153d208947ed967d6,%SourceDir%amd64\migstore.dll%Cat%
	echo fil9ed75dd36bac533143ab916b86db2be1,%SourceDir%amd64\migcore.dll%Cat%
	echo fil16a2e49b67b9114c1c4436030a1e15e3,%SourceDir%amd64\migsys.dll%Cat%
	echo fil404cd35d7a3a67b48ef14f560351ea33,%SourceDir%amd64\migres.dll%Cat%
	echo fil29c4e20a8750134f4ec29a3d4b229d78,%SourceDir%amd64\MigApp.xml%Cat%
	echo fil43c29c658ccc30fdc9e6427866362c5a,%SourceDir%amd64\MigUser.xml%Cat%
	echo fil85fde9b3b5be7cb253c0f49c6a9bd006,%SourceDir%amd64\MigDocs.xml%Cat%
	echo fil6b6527734dc81ace553e6971d29c73f0,%SourceDir%amd64\MigXML.xsd%Cat%
	echo fileec0d3fe58c7264271dc5fe81dd2b518,%SourceDir%amd64\Config_AppsOnly.xml%Cat%
	echo fil13218967ee5b26912433cb8b37058880,%SourceDir%amd64\Config_SettingsOnly.xml%Cat%
	echo fil86672a726ddc64934384f044ba903494,%SourceDir%amd64\Config_AppsAndSettings.xml%Cat%
	echo fil80ce96fa5271ec285a39025ce3b94de8,%SourceDir%amd64\cmi2migxml.dll%Cat%
	echo fil08c981ed7e7e04b15abf4bc93c21ff1e,%SourceDir%amd64\loadstate.exe%Cat%
	echo fil1158c0ff54f05fc08c186c75f567ee05,%SourceDir%amd64\ReplacementManifests7\Application-Experience-Program-Compatibility-Assistant-Replacement.man%Cat%
	echo filb038d02d2c039c0ae930a2bbc461087d,%SourceDir%amd64\ReplacementManifests7\eudcedit-replacement.man%Cat%
	echo fil11d53066a155ed023472742b0ad3ded5,%SourceDir%amd64\ReplacementManifests7\ExtensibleAuthenticationProtocolHostService-Rep.man%Cat%
	echo filc5ab47c276c1bcc62041ffa3e33cd739,%SourceDir%amd64\ReplacementManifests7\International-Core-replacement.man%Cat%
	echo fil6cbc327dbbc0fb33c2842d9c52f2d5f9,%SourceDir%amd64\ReplacementManifests7\Microsoft-Windows-Fax-Service-Replacement.man%Cat%
	echo fil37254a93acceacc8f49af7d7f029625d,%SourceDir%amd64\ReplacementManifests7\Microsoft-Windows-IE-InternetExplorer-repl.man%Cat%
	echo fil542541325bacc8e5312583f379dac49a,%SourceDir%amd64\ReplacementManifests7\Microsoft-Windows-NETFX35CDFComp-Replacement.man%Cat%
	echo fileec44fdec81c618d5497f5c05bb4ebd0,%SourceDir%amd64\ReplacementManifests7\Microsoft-Windows-OfflineFiles-Replacement.man%Cat%
	echo filb289cc5da8c0867399d85fc76880b925,%SourceDir%amd64\ReplacementManifests7\Microsoft-Windows-WCFCoreComp-Replacement.man%Cat%
	echo fil0fe3724f90d2bc63fd5f8443b11132d3,%SourceDir%amd64\ReplacementManifests7\mmsys-Migration-Replacement.man%Cat%
	echo fil290eb11aa9a3b0064cf2ff71a3c5d2bb,%SourceDir%amd64\ReplacementManifests7\odbc32dll-Repl.man%Cat%
	echo fil2d5d0763782b79321d28290b5c7cdc3f,%SourceDir%amd64\ReplacementManifests7\Printing-LocalPrinting-Replacement.man%Cat%
	echo filea57901db0811cadfdfb5b17056c2cea,%SourceDir%amd64\ReplacementManifests7\RasApi-Repl.man%Cat%
	echo file5c6f5d435b6af6820ca9351f6267812,%SourceDir%amd64\ReplacementManifests7\RasmanService-Repl.man%Cat%
	echo fil8d62f32fa98e07243f9d0804b6c3090b,%SourceDir%amd64\ReplacementManifests7\Rasppp-Repl.man%Cat%
	echo fil6e85e143f8aa977097bde5c4b997feaa,%SourceDir%amd64\ReplacementManifests7\Rights-Management-Client-v1-API-Replacement.man%Cat%
	echo fil44c7987487da9ad49967ce2347fc0140,%SourceDir%amd64\ReplacementManifests7\shmig-Replacement.man%Cat%
	echo filab91bae2b1f350d42772344b17e39536,%SourceDir%amd64\ReplacementManifests7\sounds-Migration-Replacement.man%Cat%
	echo filfd2b2d36d9e0b7a19df434a74f54f17f,%SourceDir%amd64\ReplacementManifests7\stickyNotes-Replacement.man%Cat%
	echo fil25e0ec06b3e074be6b073f5c383c1347,%SourceDir%amd64\ReplacementManifests7\sysdm-replacement.man%Cat%
	echo filbb5e96bc84dd795f8ab8692197afe71c,%SourceDir%amd64\ReplacementManifests7\SysMain-Replacement.man%Cat%
	echo fil4992da760c1e097cb1b64359b4779ae2,%SourceDir%amd64\ReplacementManifests7\TabletPCStickyNotes-Replacement.man%Cat%
	echo fil402352635ecd8be0c3a93967b788636b,%SourceDir%amd64\ReplacementManifests7\TerminalServices-AppServer-Licensing-Replacement.man%Cat%
	echo fil89fe6bbfbb9933d52f2ca7f0cda04e05,%SourceDir%amd64\ReplacementManifests7\TerminalServices-LicenseServer-Replacement.man%Cat%
	echo fild8109b93c355454af3c9ef7456d623dd,%SourceDir%amd64\ReplacementManifests7\TerminalServices-Manager-SnapIn-Replacement.man%Cat%
	echo fil43094ad27421ccb94a764dbf0f9f1586,%SourceDir%amd64\ReplacementManifests7\TerminalServices-RAPWebPart-Replacement.man%Cat%
	echo fil682333d85843c2009aee89dd01c99472,%SourceDir%amd64\ReplacementManifests7\WCF-HTTP-Activation-Replacement.man%Cat%
	echo fil6bc67948fed1ca184e06c4b3f0d0449b,%SourceDir%amd64\ReplacementManifests7\WCF-NonHTTP-Activation-Replacement.man%Cat%
	echo fil15be6dab52561642ca2e74a951dde6bf,%SourceDir%amd64\ReplacementManifests7\WindowsSearchEngine-replacement.man%Cat%
	echo fil8e1f608216b6ffb0ddf5adc368a56d0d,%SourceDir%amd64\ReplacementManifests7\WSRM-Service-Replacement.man%Cat%
	echo fila429822775d05547fcca2a1ed22d7ea1,%SourceDir%amd64\ReplacementManifests8\Application-Experience-Program-Compatibility-Assistant-Replacement.man%Cat%
	echo fil6d6ed58eba6a65fa7b205f2484839cee,%SourceDir%amd64\ReplacementManifests8\CAPI2_certs-repl.man%Cat%
	echo fil458f26d6864375b910138e174370695e,%SourceDir%amd64\ReplacementManifests8\CertificateEnrollment-Replacement.man%Cat%
	echo fil1f3c8c87c89f4ecbbae781fe6c7f53a9,%SourceDir%amd64\ReplacementManifests8\DisplayConfigSettings_Win7Update.man%Cat%
	echo fil3f0b4fbc51003367c4190c6abd228390,%SourceDir%amd64\ReplacementManifests8\eudcedit-replacement.man%Cat%
	echo fild2754f8b0ff23c2323afc7ec8a19efef,%SourceDir%amd64\ReplacementManifests8\explorer-repl.man%Cat%
	echo fil43db26560b07393b6059514e574a6f54,%SourceDir%amd64\ReplacementManifests8\ExtensibleAuthenticationProtocolHostService-Rep.man%Cat%
	echo filadc14191fe71bd7e0bde3a37ac265866,%SourceDir%amd64\ReplacementManifests8\IdentityServer-Migration-Replacement.man%Cat%
	echo fil8f09f97d9c8d27be5a5a7b94ef1560a6,%SourceDir%amd64\ReplacementManifests8\IdentityServer-ProxyMigration-Replacement.man%Cat%
	echo fil5dc1a80788bfc14d095adbae8e095baf,%SourceDir%amd64\ReplacementManifests8\International-Core-replacement.man%Cat%
	echo fil4c712ae060cca9942cead8ca64e31ccb,%SourceDir%amd64\ReplacementManifests8\Internet-Naming-Service-Runtime-Rep.man%Cat%
	echo fil4ded3bd953a16d9aeac781044d500518,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-Fax-Service-Replacement.man%Cat%
	echo filca69123c6e89083271a1b5c0f534a957,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-Identity-Foundation-Migration-Replacement.man%Cat%
	echo fil63c7ab92d0c6f428a106bb1b1ed32039,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-IE-InternetExplorer-repl.man%Cat%
	echo fil96c0a0a5c65ba40da872c0f0a488b18a,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-IE-PDM-Replacement.man%Cat%
	echo fil2af2e2a99d53a30ec4409b5bd5f82cd7,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-NETFX35CDFComp-Replacement.man%Cat%
	echo fil8426ce9bc381233a9158210aeedefc1c,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-OfflineFiles-Replacement.man%Cat%
	echo fil02b3bfaccb2a570aaaaf8df59319a51d,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-PowerShell-Replacement.man%Cat%
	echo fil4c3f1cf742236fc730b4e77753e240f6,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-PowerShell-WS08-Replacement.man%Cat%
	echo fil4ac6d216cb3fd4602267a993b422bbd8,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-WCFCoreComp-Replacement.man%Cat%
	echo fild4635c2c2ec1214460abeee945c657d3,%SourceDir%amd64\ReplacementManifests8\mmsys-Migration-Replacement.man%Cat%
	echo filabde5f39147c4ac930d2a9057b931ac4,%SourceDir%amd64\ReplacementManifests8\Netfx4-Policy-Replacement.man%Cat%
	echo file84b5bd3274f953122167920f23bc4e0,%SourceDir%amd64\ReplacementManifests8\odbc32dll-Repl.man%Cat%
	echo fil06065a47d03d96c49890f003f62d9504,%SourceDir%amd64\ReplacementManifests8\PeerDist-Client-Migration-Replacement.man%Cat%
	echo filcc83a70680dda2b9ea81cc97aec3bb19,%SourceDir%amd64\ReplacementManifests8\PeerDist-Server-Migration-Replacement.man%Cat%
	echo fil96706cc73db3ea4b548e66ec5c67b34a,%SourceDir%amd64\ReplacementManifests8\Printing-LocalPrinting-Replacement.man%Cat%
	echo fil172b01124c55598ab332a6ea3a784518,%SourceDir%amd64\ReplacementManifests8\RasApi-Repl.man%Cat%
	echo fil48feee2b8e5fb790ee641f2dbf351a78,%SourceDir%amd64\ReplacementManifests8\RasBase-Rassstp-Repl.man%Cat%
	echo fil7bc7062c14a877f1f9757c7121453f8c,%SourceDir%amd64\ReplacementManifests8\RasBase-Repl.man%Cat%
	echo fil90dc5b1a22903078fc8ba6cce3f653b3,%SourceDir%amd64\ReplacementManifests8\RasmanService-Repl.man%Cat%
	echo fil6b8541fc9295073f876bc7129f84963e,%SourceDir%amd64\ReplacementManifests8\RasmanService-ReplV2.man%Cat%
	echo fild2c25ea86840ec5752dbcb8bce75acb5,%SourceDir%amd64\ReplacementManifests8\Rasppp-Repl.man%Cat%
	echo filf62799b46e00c0a456983b557c332c89,%SourceDir%amd64\ReplacementManifests8\RasRqs-Repl.man%Cat%
	echo fil9297ec66ed17796582681c3c617a46fb,%SourceDir%amd64\ReplacementManifests8\Rights-Management-Client-v1-API-Replacement.man%Cat%
	echo fil8eb0a4ea16bb3fc4baa010d7831551cb,%SourceDir%amd64\ReplacementManifests8\shmig-replacement.man%Cat%
	echo fil4e8a43dd89d0ed34a6cca0a579bd9405,%SourceDir%amd64\ReplacementManifests8\sounds-Migration-Replacement.man%Cat%
	echo fild3448425ab65444cb96a090c926150c4,%SourceDir%amd64\ReplacementManifests8\stickyNotes-Replacement.man%Cat%
	echo filc3613f306a813fb0ff5f7e90834301e7,%SourceDir%amd64\ReplacementManifests8\sysdm-replacement.man%Cat%
	echo fila382254fb9a2e73ecc4c43c9bdc46242,%SourceDir%amd64\ReplacementManifests8\SysMain-Replacement.man%Cat%
	echo fil175bfe91a13e1d363c7270fa4a16464b,%SourceDir%amd64\ReplacementManifests8\TabletPCStickyNotes-Replacement.man%Cat%
	echo fild0b29f4018c4bd2acb1fe1e1be2c3772,%SourceDir%amd64\ReplacementManifests8\TerminalServices-AppServer-Licensing-Replacement.man%Cat%
	echo fil6dec950a9880554838a54840297328a8,%SourceDir%amd64\ReplacementManifests8\TerminalServices-LicenseServer-Replacement.man%Cat%
	echo filbec68dc701280bfb7dc9c2ef92a3797e,%SourceDir%amd64\ReplacementManifests8\TerminalServices-RAPWebPart-Replacement.man%Cat%
	echo fil472a5ec4480fa78c10b94f656fca688c,%SourceDir%amd64\ReplacementManifests8\TerminalServices-RDP-WinStationExtensions-Replacement.man%Cat%
	echo fildba3ee3df5c277d9d98aef98e2868e7d,%SourceDir%amd64\ReplacementManifests8\TerminalServices-SessionDirectory-Client-Replacement.man%Cat%
	echo fil6d5bddfcf414256654f4ae3e62c9066f,%SourceDir%amd64\ReplacementManifests8\UDFS-Replacement.man%Cat%
	echo fil11ebe28b7edb17c7636c623af53bc37c,%SourceDir%amd64\ReplacementManifests8\VirtualDiskService-Repl.man%Cat%
	echo fildb40774e8774bbfd2081ae65323675de,%SourceDir%amd64\ReplacementManifests8\WCF-HTTP-Activation-Replacement.man%Cat%
	echo fil09bca47a876a9f2b48314dd94c25996a,%SourceDir%amd64\ReplacementManifests8\WCF-NonHTTP-Activation-Replacement.man%Cat%
	echo fil2ea199be73185e0b2f3239c95b007c35,%SourceDir%amd64\ReplacementManifests8\WindowsSearchEngine-replacement.man%Cat%
	echo fil3799a92049abd257290dac7be46ac36c,%SourceDir%amd64\ReplacementManifests8\Winlogon-Replacement.man%Cat%
	echo fil81528df796305318c5bd06e2c4cafdfe,%SourceDir%amd64\ReplacementManifests8\WSRM-Service-Replacement.man%Cat%
	echo fild3d2ffde2a657487abe16b475f312c1e,%SourceDir%amd64\ReplacementManifests7\Microsoft-Windows-shmig\shmig.dll%Cat%
	echo fil5ce719163ae44b50421d12a15878bcb4,%SourceDir%amd64\ReplacementManifests7\Microsoft-Windows-TerminalServices-LicenseServer\TlsRepPlugin.dll%Cat%
	echo fil73074b586dec2194be75d44bf0fe6172,%SourceDir%amd64\ReplacementManifests7\WindowsSearchEngine\WSearchMigPlugin.dll%Cat%
	echo fil25a1106466d69ca33ea7b73c44241e28,%SourceDir%amd64\ReplacementManifests8\Microsoft-Windows-shmig\shmig.dll%Cat%
	echo fila77ca8c745e9a87257886a05ef195a29,%SourceDir%amd64\ReplacementManifests8\WindowsSearchEngine\WSearchMigPlugin.dll%Cat%
	echo filc5977509e565b448212d524dcf927ac2,%SourceDir%amd64\scanstate.exe%Cat%
	echo fild8496ee0fed10f4cacc58c738be101ad,%SourceDir%amd64\usmtutils.exe%Cat%
	echo fil31745520cd10064b730a8693687fcd78,%SourceDir%amd64\SFPAT.INF%Cat%
	echo fil568d131d65667559b9a19261eeccb4ef,%SourceDir%amd64\SFPATRS1.INF%Cat%
	echo fil27d3d330c388080f5bb48fde756ed8cb,%SourceDir%amd64\SFPATWT.INF%Cat%
	echo fil6126f2a3c192150cc4f1445052b76563,%SourceDir%amd64\SFPATWB.INF%Cat%
	echo filafa69bb0930d55d7ba9b276c397a3b0e,%SourceDir%amd64\SFPATW8.INF%Cat%
	echo fil1529bc89115887919ef2c22f9414be54,%SourceDir%amd64\SFPATW7.INF%Cat%
	echo fil2fe985ef795c1b502a2e6813a1bb4eba,%SourceDir%amd64\SFCN.DAT%Cat%
	echo fild80d7c58be300f7e989e8c1f5c7614b6,%SourceDir%amd64\SFLCID.DAT%Cat%
	echo fil3187a1d4de363a2d36dcb552fbc477b8,%SourceDir%amd64\SFLISTRS1.DAT%Cat%
	echo fil4fd7b41ff07e270cde99a98db6dc8db5,%SourceDir%amd64\SFLISTWT.DAT%Cat%
	echo fil814a0e2c92c20606fbf7b83dca02e25c,%SourceDir%amd64\SFLISTWT.WOA.DAT%Cat%
	echo fil68b53f36c885794a952be32c18b224e1,%SourceDir%amd64\SFLISTWB.DAT%Cat%
	echo fildbe94a31b756971e77f42ee7b30fca23,%SourceDir%amd64\SFLISTWB.WOA.DAT%Cat%
	echo fil5ac1a91f5b2a33938271bf618b54120c,%SourceDir%amd64\SFLISTW8.DAT%Cat%
	echo fil6fe2a89afacf506d22d7fab64e451916,%SourceDir%amd64\SFLISTW8.WOA.DAT%Cat%
	echo fil60eb735573d46df23d1b3d3727947a69,%SourceDir%amd64\SFLISTW7.DAT%Cat%
	echo fil65cd97d8831a0f042d471eff5bcd0bad,%SourceDir%amd64\unbcl.dll%Cat%
	echo fil9a0029eb5db5d5774aec6d7a3bb9482d,%SourceDir%amd64\ReplacementManifests\VirtualDiskService-Repl.man%Cat%
	echo fil5a847e601dbc20b79f3cbe83bef33c68,%SourceDir%amd64\DLManifests\International-TimeZones-DL.man%Cat%
	echo fil66390bff457b851f0261fd5ae62e5f70,%SourceDir%amd64\ReplacementManifests\International-Core-replacement.man%Cat%
	echo fil041043aac3f22ad0a23cae3f631f44d3,%SourceDir%amd64\ReplacementManifests\IdentityServer-Migration-Replacement.man%Cat%
	echo fil24e4eeb6ad6058a788f3a2436188ec13,%SourceDir%amd64\ReplacementManifests\IdentityServer-ProxyMigration-Replacement.man%Cat%
	echo filf87ea8d6c8e010cbad105cd485bd5764,%SourceDir%amd64\DLManifests\dpapi_keys-DL.man%Cat%
	echo fil0e42e92357927b876a7f3c8b99b313d2,%SourceDir%amd64\ReplacementManifests\dpapi_keys-repl.man%Cat%
	echo filbaec2c2fc8cd18afa8d62f99a444f273,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-Identity-Foundation-Migration-Replacement.man%Cat%
	echo fil9d2dddba994a02ba3c8247d267c8a995,%SourceDir%amd64\ReplacementManifests\Rights-Management-Client-v1-API-Replacement.man%Cat%
	echo filaa2c77dd75b54028b435ba8b8491183b,%SourceDir%amd64\ReplacementManifests\Winlogon-Replacement.man%Cat%
	echo fil5d242080fbfa015cd34ef2b082b7d00f,%SourceDir%amd64\ReplacementManifests\odbc32dll-Repl.man%Cat%
	echo fil01471d326c9df863535150033ef50c98,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-IE-InternetExplorer-repl.man%Cat%
	echo filfda7b032214f07752c72327cc5bcf849,%SourceDir%amd64\ReplacementManifests\ReFS-Replacement.man%Cat%
	echo fil0cd8761297697126d96eb9b65f6d7eb3,%SourceDir%amd64\ReplacementManifests\ReFS-v1-Replacement.man%Cat%
	echo fila05c770b89574992ecc0b417e7dd28a2,%SourceDir%amd64\ReplacementManifests\mmsys-Migration-Replacement.man%Cat%
	echo filbbb0253161b5c1dbfa0c3dc7040aa9c0,%SourceDir%amd64\ReplacementManifests\sounds-Migration-Replacement.man%Cat%
	echo fild2309d13c06233e879bc6058a0a46cc4,%SourceDir%amd64\ReplacementManifests\PeerDist-Server-Migration-Replacement.man%Cat%
	echo fil1b5418bf4f94a6d4cdf3b0988b3a1f6e,%SourceDir%amd64\ReplacementManifests\PeerDist-Client-Migration-Replacement.man%Cat%
	echo filafce5d237872303f68304843f32c2838,%SourceDir%amd64\ReplacementManifests\RasApi-Repl.man%Cat%
	echo fil99f42ab3f36ded80811dfa54524fdd79,%SourceDir%amd64\ReplacementManifests\RasRqs-Repl.man%Cat%
	echo fil62e9b17444597d82992d29c05a9daf63,%SourceDir%amd64\ReplacementManifests\RasBase-Rassstp-Repl.man%Cat%
	echo fil5526dd1c4f7bb24566c4c61d2d0fbc2d,%SourceDir%amd64\ReplacementManifests\Internet-Naming-Service-Runtime-Rep.man%Cat%
	echo fil10b6cb4f3cb15a35dc48647c9a3a2abb,%SourceDir%amd64\ReplacementManifests\UDFS-Replacement.man%Cat%
	echo fil0f2bb15675a7045d7a3a3eb1b129ee5b,%SourceDir%amd64\ReplacementManifests\PCPKsp_dll-repl.man%Cat%
	echo fil9a98be5762134526dae9c0b5cb7f1783,%SourceDir%amd64\wdscore.dll%Cat%
	echo filc4a4c160d236e694b9be34d87fa9e77e,%SourceDir%amd64\ReplacementManifests\SysMain-Replacement.man%Cat%
	echo fil42a24924949c5a51a2257afa00a32cb0,%SourceDir%amd64\ReplacementManifests\CAPI2_certs-repl.man%Cat%
	echo fila985f8dc27d8d4b8bd06a4d80d5279cf,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-Security-NGC-CtnrSvc-repl.man%Cat%
	echo fil45ffb71fd9910a6ac4c1341aede25f75,%SourceDir%amd64\ReplacementManifests\ngcpopkeysrv_dll-repl.man%Cat%
	echo fil3428070600bcf8820aadac32073f3bf9,%SourceDir%amd64\ReplacementManifests\CertificateEnrollment-Replacement.man%Cat%
	echo file14c98e04132544d622e3d45c68783d3,%SourceDir%amd64\ReplacementManifests\WindowsSearchEngine-replacement.man%Cat%
	echo filf73b056dcbcc650aa60341a759ad3f1e,%SourceDir%amd64\ReplacementManifests\WindowsSearchEngine\WSearchMigPlugin.dll%Cat%
	echo filf2d7487a3b136387823824855db078d9,%SourceDir%amd64\ReplacementManifests\wlidsvc.vista-win7.man%Cat%
	echo filc9ba88b030222457a89bbe4e82da4a73,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-IE-ClientNetworkProtocolImplementation-repl.man%Cat%
	echo fila0b47bf49f4f1ec306713a7d75f912ba,%SourceDir%amd64\ReplacementManifests\ExtensibleAuthenticationProtocolHostService-Rep.man%Cat%
	echo filcf739bda5bf4ec2428eceb3c4f2d8873,%SourceDir%amd64\ReplacementManifests\Rasppp-Repl.man%Cat%
	echo fil6427749e624d757362eef8753f8413f1,%SourceDir%amd64\ReplacementManifests\RasmanService-Repl.man%Cat%
	echo fild5531355446833dd31d6d6f42240940a,%SourceDir%amd64\ReplacementManifests\RasmanService-ReplV2.man%Cat%
	echo fild59c142b7b4bf8c1702333ebe304e624,%SourceDir%amd64\ReplacementManifests\RasBase-Repl.man%Cat%
	echo fild6d914d8da0e5db412ee3a307004d1dd,%SourceDir%amd64\ReplacementManifests\UPnPDeviceHost-Replacement.man%Cat%
	echo fil1f7950f405751c70a6062f6a57f59952,%SourceDir%amd64\ReplacementManifests\UPnPDeviceHost-Server-Replacement.man%Cat%
	echo fild8d792042680849e23cc88fceec0e863,%SourceDir%amd64\ReplacementManifests\UPnPSSDP-Replacement.man%Cat%
	echo filf6c18cfa8b4b9c6531ced358fe818f52,%SourceDir%amd64\ReplacementManifests\UPnPSSDP-Server-Replacement.man%Cat%
	echo fil8fd11ca55543f52664270caa3ccd1a91,%SourceDir%amd64\ReplacementManifests\win32k-settings-repl.man%Cat%
	echo filef0926e52109534c162702128ec3de96,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-Fax-Service-Replacement.man%Cat%
	echo fil5c3e75375a50e165da54a8627a54ab3c,%SourceDir%amd64\ReplacementManifests\Printing-LocalPrinting-Replacement.man%Cat%
	echo fil1c3f0f79bf84421ac1761f92a14d3984,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-NETFX35CDFComp-Replacement.man%Cat%
	echo fil9819f031a857df4530bc5f3f13979c53,%SourceDir%amd64\ReplacementManifests\Netfx4-Policy-Replacement.man%Cat%
	echo fil6d98d99f78be75bd363c06c3d2060e14,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-WCFCoreComp-Replacement.man%Cat%
	echo fil85d3ffde7f5297ea76818af5ff4f5d44,%SourceDir%amd64\ReplacementManifests\WCF-HTTP-Activation-Replacement.man%Cat%
	echo fil7cef0caa7bc5c36ca4b3f4bfdd2311d0,%SourceDir%amd64\ReplacementManifests\WCF-NonHTTP-Activation-Replacement.man%Cat%
	echo filf7b917ebed777eb21958431f38950d83,%SourceDir%amd64\ReplacementManifests\sysdm-replacement.man%Cat%
	echo fil035bc85a97ab9db0a13f43f88ac43ee1,%SourceDir%amd64\ReplacementManifests\explorer-repl.man%Cat%
	echo fil2e60a5bc574c29f28ab941827de891ee,%SourceDir%amd64\ReplacementManifests\eudcedit-replacement.man%Cat%
	echo fil3d43809b391be9ed40cbfab069edb08b,%SourceDir%amd64\ReplacementManifests\notepad-repl.man%Cat%
	echo filfd656620d2c05a1dbf362be9910492f5,%SourceDir%amd64\ReplacementManifests\shmig-replacement.man%Cat%
	echo fild1e1edbeacf569427adc113eeb8755cd,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-shmig\shmig.dll%Cat%
	echo fil2c3a29f0a22da33327ad84e0aebf15c8,%SourceDir%amd64\ReplacementManifests\TerminalServices-AppServer-Licensing-Replacement.man%Cat%
	echo fil718b7254b70500ef5d007e6de00a9408,%SourceDir%amd64\ReplacementManifests\TerminalServices-RAPWebPart-Replacement.man%Cat%
	echo fil46ad7971df4873cb1a336af57b19f0bc,%SourceDir%amd64\ReplacementManifests\TerminalServices-LicenseServer-Replacement.man%Cat%
	echo fil4b541d3ab0d705c48cce1085b4c8f6bc,%SourceDir%amd64\ReplacementManifests\TerminalServices-RDP-WinStationExtensions-Replacement.man%Cat%
	echo fil22a3c3edd38922ce4221c605d9a19055,%SourceDir%amd64\ReplacementManifests\TerminalServices-SessionDirectory-Client-Replacement.man%Cat%
	echo fil044a8f845e49ff82fb2b1f7b668da816,%SourceDir%amd64\DLManifests\TextServicesFramework-Migration-DL.man%Cat%
	echo fil6fd948faae5c0d4e24b2e18ffd895a27,%SourceDir%amd64\ReplacementManifests\TextServicesFramework-Migration-Replacement.man%Cat%
	echo fil51c1539cc035d5b3cc5f5a159134c1c9,%SourceDir%amd64\DLManifests\Microsoft-Windows-TextServicesFramework-Migration-DL\msctfmig.dll%Cat%
	echo file0e48ee6704f5957ed4962fc004e70e2,%SourceDir%amd64\ReplacementManifests\Microsoft-Windows-TextServicesFramework-Migration\msctfmig.dll%Cat%
	echo fil3ca3b545b8feebbdd7a19279fea857a9,%SourceDir%amd64\ReplacementManifests\DisplayConfigSettings_Win7Update.man%Cat%
	for /f "tokens=1,2 delims=," %%a in (Catalog.csv) do (
		md "%%b"
		rd "%%b"
		move %%a "%%b" >nul
	)
	popd
)

:ARM64
if exist %Cab_ARM64% (
	cls
	%echo%
	echo.
	echo Extracting USMT arm64...
	echo.
	%echo%
	md USMT\arm64
	expand -f:* %Cab_ARM64% USMT\arm64 >nul
	pushd USMT\arm64
	echo fil09abcc6129491a14904dbea2850e5e44,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-ServerManager-Shell-Replacement.man%Cat%
	echo fil77c4ba4305c5035a5bff6f006231e12b,%SourceDir%arm64\ReplacementManifests\msmpeg2vdec-migration-replacement.man%Cat%
	echo fil80d40f8da852a98c3100def65e58926f,%SourceDir%arm64\ReplacementManifests\mfsrcsnk-migration-replacement.man%Cat%
	echo fil6a969ac991087da41b4542f17f6e94c7,%SourceDir%arm64\ReplacementManifests\mfmpeg2srcsnk-migration-replacement.man%Cat%
	echo fildb28b7ab4651ffdb9ff6770b0233c458,%SourceDir%arm64\ReplacementManifests\winmde-migration-replacement.man%Cat%
	echo filf5869d14baa3878edfed764369616c10,%SourceDir%arm64\ReplacementManifests\Application-Experience-Program-Compatibility-Assistant-Replacement.man%Cat%
	echo fil70235f36a5a7437de4fa996159f34ca1,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-OfflineFiles-Replacement.man%Cat%
	echo fil3dabe8b0f580450f0422e984f4ad65bb,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-OfflineFiles-Core\cscmig.dll%Cat%
	echo fila11f0a21ab701c99e80acfe18b1d71c7,%SourceDir%arm64\ReplacementManifests\DataIntegrityScan-Replacement.man%Cat%
	echo fil6023ecbe12048a626964f42a3ba5f047,%SourceDir%arm64\csiagent.dll%Cat%
	echo fila43da27b4b987a0f7a7e549ced7e8fa6,%SourceDir%arm64\mxeagent.dll%Cat%
	echo fil75adbe99f1450b649fbf47abf252fc32,%SourceDir%arm64\mighost.exe%Cat%
	echo fil1090d2861a0bb602002cfefd8b0be213,%SourceDir%arm64\migstore.dll%Cat%
	echo fil3eeec4b157691f83eadebe8290613a3b,%SourceDir%arm64\migcore.dll%Cat%
	echo fil5cb2c9d0990ff1ebcef2d5ad54cdf858,%SourceDir%arm64\migsys.dll%Cat%
	echo fildb0dfaf8990062a2fb1ed6b267ee99c0,%SourceDir%arm64\migres.dll%Cat%
	echo fil3d580daf98b54c99d4435adbd874304e,%SourceDir%arm64\MigApp.xml%Cat%
	echo fil3f1d7cf0de5db187c62a16a3a371180c,%SourceDir%arm64\MigUser.xml%Cat%
	echo fild71973a7b0af7afd50aaecfe46477426,%SourceDir%arm64\MigDocs.xml%Cat%
	echo filb72ee188fcf35c2170422f308240b992,%SourceDir%arm64\MigXML.xsd%Cat%
	echo fil4cf349f69073802540f04edf86bdfc03,%SourceDir%arm64\Config_AppsOnly.xml%Cat%
	echo fil0a4d008db7c05d563051f57ee1f58948,%SourceDir%arm64\Config_SettingsOnly.xml%Cat%
	echo fil7399178dd5739ba38f987d9276d89059,%SourceDir%arm64\Config_AppsAndSettings.xml%Cat%
	echo fild449f37e192a133341ee46762f264258,%SourceDir%arm64\cmi2migxml.dll%Cat%
	echo fil111dfa75ff03d10a8848f9fa7311e68c,%SourceDir%arm64\SFPAT.INF%Cat%
	echo fil9a3a6f99322ca72087e4b52e3749906c,%SourceDir%arm64\SFPATRS1.INF%Cat%
	echo filffe1cb786016bc26c634c906109365ba,%SourceDir%arm64\SFPATWT.INF%Cat%
	echo filea262b7cf3226c827682a1f657d1f330,%SourceDir%arm64\SFPATWB.INF%Cat%
	echo fila7ea36a3163da3e9e6841757e0324776,%SourceDir%arm64\SFPATW8.INF%Cat%
	echo fil6ff6c470bd6fe4aa1ebf439deaefb703,%SourceDir%arm64\SFPATW7.INF%Cat%
	echo fil425cf3135eafd67b0b214bbffcb92381,%SourceDir%arm64\SFCN.DAT%Cat%
	echo filb111bf555a501a0b2995a724a02e8aff,%SourceDir%arm64\SFLCID.DAT%Cat%
	echo fildd37cbf10f04a86b29d5bb0293dad8b9,%SourceDir%arm64\SFLISTRS1.DAT%Cat%
	echo filf282e2ee6cd073c6de6486ed101ded84,%SourceDir%arm64\SFLISTWT.DAT%Cat%
	echo fil59d4df6447274ff30f740c918a14d9e5,%SourceDir%arm64\SFLISTWT.WOA.DAT%Cat%
	echo fild40a5dfada6128d48707fbe9d3dd0dd2,%SourceDir%arm64\SFLISTWB.DAT%Cat%
	echo fil2879f854ffd0eb27938552b633a886b0,%SourceDir%arm64\SFLISTWB.WOA.DAT%Cat%
	echo fil1f0fe42d3869e3cad81a475d8fdf48e9,%SourceDir%arm64\SFLISTW8.DAT%Cat%
	echo filb1ccdc69d23fb4090f8b518d392006a3,%SourceDir%arm64\SFLISTW8.WOA.DAT%Cat%
	echo fil4e1fbfb74b9ae6b9c0e61ff0157bdaf4,%SourceDir%arm64\SFLISTW7.DAT%Cat%
	echo fil2599fa433ad58d66ff4ba3a879841964,%SourceDir%arm64\unbcl.dll%Cat%
	echo fil960e958d875683cd303235da9143304c,%SourceDir%arm64\ReplacementManifests\VirtualDiskService-Repl.man%Cat%
	echo fil3028e04861941064cdd5cd9c569dd11d,%SourceDir%arm64\DLManifests\International-TimeZones-DL.man%Cat%
	echo fil94a437d2412a71be1cdac392595a15de,%SourceDir%arm64\ReplacementManifests\International-Core-replacement.man%Cat%
	echo fil54c46b2419b5b4717f97670dfbc1f82f,%SourceDir%arm64\DLManifests\dpapi_keys-DL.man%Cat%
	echo filef01323286f96bd57cf06d985365ed8c,%SourceDir%arm64\ReplacementManifests\dpapi_keys-repl.man%Cat%
	echo fil0ab9ff275ffa15d8dcc77e21c9ba66a5,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-Identity-Foundation-Migration-Replacement.man%Cat%
	echo filbc8cd2e8447403cb54c7aa18053241d2,%SourceDir%arm64\ReplacementManifests\Rights-Management-Client-v1-API-Replacement.man%Cat%
	echo filc697ad0c9814a2ece5275d113bbc9d7f,%SourceDir%arm64\ReplacementManifests\Winlogon-Replacement.man%Cat%
	echo fil3b41c82535e01589669837a944cdf9e0,%SourceDir%arm64\ReplacementManifests\odbc32dll-Repl.man%Cat%
	echo fil93b05dcee24be5de2f53a1709f4778c5,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-IE-InternetExplorer-repl.man%Cat%
	echo filfb6e8d40b7b97496318ca1a1f3bca659,%SourceDir%arm64\ReplacementManifests\ReFS-Replacement.man%Cat%
	echo fil53ce4fd5c7693ed8e798f0ecfdcd1c54,%SourceDir%arm64\ReplacementManifests\ReFS-v1-Replacement.man%Cat%
	echo fil37dbe83c6e7d521c3e77a65cc51d2115,%SourceDir%arm64\ReplacementManifests\mmsys-Migration-Replacement.man%Cat%
	echo fila30a33f151acc55f99322cbf82058b87,%SourceDir%arm64\ReplacementManifests\sounds-Migration-Replacement.man%Cat%
	echo fil48f80517cbe14666d27eb72f55cd27bd,%SourceDir%arm64\ReplacementManifests\PeerDist-Server-Migration-Replacement.man%Cat%
	echo fil7431a222090e7d68a4f426ad2c3bf804,%SourceDir%arm64\ReplacementManifests\PeerDist-Client-Migration-Replacement.man%Cat%
	echo fil08e2933a14542ab0d16baa2b37464a7d,%SourceDir%arm64\ReplacementManifests\RasApi-Repl.man%Cat%
	echo filb7f3839bb98fb0e73301f4e0451fe088,%SourceDir%arm64\ReplacementManifests\RasRqs-Repl.man%Cat%
	echo fil4a240fd232364bf7fbeda4bcf79f589e,%SourceDir%arm64\ReplacementManifests\RasBase-Rassstp-Repl.man%Cat%
	echo fil30a3beebfae63f3e610427dabbed3f6f,%SourceDir%arm64\ReplacementManifests\Internet-Naming-Service-Runtime-Rep.man%Cat%
	echo fil5d4af90d160fcb76e2f7812af8669897,%SourceDir%arm64\ReplacementManifests\UDFS-Replacement.man%Cat%
	echo fil0a46c5889b1512d9b9a80e3f709ae23c,%SourceDir%arm64\ReplacementManifests\PCPKsp_dll-repl.man%Cat%
	echo filf2841a9d723b0012962f4a75edd73d9f,%SourceDir%arm64\wdscore.dll%Cat%
	echo filb382a46f30f9ba97dcdb12bfc1b1c2d2,%SourceDir%arm64\ReplacementManifests\SysMain-Replacement.man%Cat%
	echo fil753e04a43d927c3adf182ec22da2e677,%SourceDir%arm64\ReplacementManifests\CAPI2_certs-repl.man%Cat%
	echo fil8c95ea7562f45f92c4e81449a87f711e,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-Security-NGC-CtnrSvc-repl.man%Cat%
	echo fil4e21bc11aa3769729d653209f6e2754c,%SourceDir%arm64\ReplacementManifests\ngcpopkeysrv_dll-repl.man%Cat%
	echo fil1166ad9347194bb2802eee2bbe68387e,%SourceDir%arm64\ReplacementManifests\CertificateEnrollment-Replacement.man%Cat%
	echo filfb8a9428b050207a0f7ae78efb8dff6b,%SourceDir%arm64\ReplacementManifests\WindowsSearchEngine-replacement.man%Cat%
	echo filf02ef0b37b3aff535edd0b4b550471d7,%SourceDir%arm64\ReplacementManifests\WindowsSearchEngine\WSearchMigPlugin.dll%Cat%
	echo fil464422078c76715734b1917212c2b10e,%SourceDir%arm64\ReplacementManifests\wlidsvc.vista-win7.man%Cat%
	echo fil36f9b98243b3a6629f67d611741225b4,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-IE-ClientNetworkProtocolImplementation-repl.man%Cat%
	echo fil6c8a040424c6557f446a8e919f13280d,%SourceDir%arm64\ReplacementManifests\ExtensibleAuthenticationProtocolHostService-Rep.man%Cat%
	echo filff24c9ca0354256d7f792317fc48b999,%SourceDir%arm64\ReplacementManifests\Rasppp-Repl.man%Cat%
	echo fil7435fcd28684158397c3659966c3f4f5,%SourceDir%arm64\ReplacementManifests\RasmanService-Repl.man%Cat%
	echo fil8270ea13f199723e66d1ee6737bbc6b5,%SourceDir%arm64\ReplacementManifests\RasmanService-ReplV2.man%Cat%
	echo fil1c894a15a1b1ec219e3f4175e0581c39,%SourceDir%arm64\ReplacementManifests\RasBase-Repl.man%Cat%
	echo fil048a2131a237fa50d49a89cf9b94d35b,%SourceDir%arm64\ReplacementManifests\UPnPDeviceHost-Replacement.man%Cat%
	echo fil78a9e17ae9f41040d64679916e1ccf49,%SourceDir%arm64\ReplacementManifests\UPnPDeviceHost-Server-Replacement.man%Cat%
	echo filcbe1d603e29ee666ba2a6760d5eaea1b,%SourceDir%arm64\ReplacementManifests\UPnPSSDP-Replacement.man%Cat%
	echo filddb81a652af9e2975647d7c699e2e53a,%SourceDir%arm64\ReplacementManifests\UPnPSSDP-Server-Replacement.man%Cat%
	echo fil18ee568989db64531d3fa8390ebf2e26,%SourceDir%arm64\ReplacementManifests\win32k-settings-repl.man%Cat%
	echo fild42d3689cfb44ec76c6a4666315c20ec,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-Fax-Service-Replacement.man%Cat%
	echo filc44ddc9257da6f7ed464123ae433b5f9,%SourceDir%arm64\ReplacementManifests\Printing-LocalPrinting-Replacement.man%Cat%
	echo filaa7bba4ddd6cc2f412d36675e9ca0078,%SourceDir%arm64\ReplacementManifests\Netfx4-Policy-Replacement.man%Cat%
	echo filf9a3ebce35bede83ef1625d639215b98,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-WCFCoreComp-Replacement.man%Cat%
	echo fil42ef1d58a6406caef35074b6ccceb5d1,%SourceDir%arm64\ReplacementManifests\WCF-HTTP-Activation-Replacement.man%Cat%
	echo fila9ea3542163acb7106fe43682a3718e3,%SourceDir%arm64\ReplacementManifests\WCF-NonHTTP-Activation-Replacement.man%Cat%
	echo fil0bc0004202def7e64553443a96a431ea,%SourceDir%arm64\ReplacementManifests\sysdm-replacement.man%Cat%
	echo fil6738b18844144418793c6779e202ab0c,%SourceDir%arm64\ReplacementManifests\explorer-repl.man%Cat%
	echo fil7a908d48e70b2885659f5b3dc762dba5,%SourceDir%arm64\ReplacementManifests\eudcedit-replacement.man%Cat%
	echo fil0e3c11e91fb279c9e2e46a60e33c5207,%SourceDir%arm64\ReplacementManifests\notepad-repl.man%Cat%
	echo fil7f82acb6e5ec67092c959efa44e94871,%SourceDir%arm64\ReplacementManifests\shmig-replacement.man%Cat%
	echo fil30642831667da014ead960bda0a66a18,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-shmig\shmig.dll%Cat%
	echo fil45ea3a2a306d38b29b2ae3028d564f4c,%SourceDir%arm64\ReplacementManifests\TerminalServices-AppServer-Licensing-Replacement.man%Cat%
	echo fil493140ef509c10eb302e774795256cce,%SourceDir%arm64\ReplacementManifests\TerminalServices-RAPWebPart-Replacement.man%Cat%
	echo fil0e2983c9f9dae084f8a31d4f403e8cb1,%SourceDir%arm64\ReplacementManifests\TerminalServices-LicenseServer-Replacement.man%Cat%
	echo fil19b7427de7655df6c946e888f91bd624,%SourceDir%arm64\ReplacementManifests\TerminalServices-RDP-WinStationExtensions-Replacement.man%Cat%
	echo fil32d76fa8ded2e17b75c1f861a1bf2a48,%SourceDir%arm64\ReplacementManifests\TerminalServices-SessionDirectory-Client-Replacement.man%Cat%
	echo file412beb8d24647a0ff897104078263ad,%SourceDir%arm64\DLManifests\TextServicesFramework-Migration-DL.man%Cat%
	echo fil9e9083435ba769dde14f30643e63732b,%SourceDir%arm64\ReplacementManifests\TextServicesFramework-Migration-Replacement.man%Cat%
	echo fil61d55cb041e8765a036f2fd09fa2af21,%SourceDir%arm64\DLManifests\Microsoft-Windows-TextServicesFramework-Migration-DL\msctfmig.dll%Cat%
	echo fil9a23dad7f9ebaad627378952ec605337,%SourceDir%arm64\ReplacementManifests\Microsoft-Windows-TextServicesFramework-Migration\msctfmig.dll%Cat%
	echo fil526525c82d1709154c3d2fcc7347fb51,%SourceDir%arm64\ReplacementManifests\DisplayConfigSettings_Win7Update.man%Cat%
	for /f "tokens=1,2 delims=," %%a in (Catalog.csv) do (
		md "%%b"
		rd "%%b"
		move %%a "%%b" >nul
	)
	popd
)

rd /s /q USMT